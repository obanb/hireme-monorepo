enum ReservationStatus {
  PENDING
  CONFIRMED
  CANCELLED
}

type Reservation {
  id: ID!
  originId: String
  guestName: String
  guestEmail: String
  guestId: ID
  guest: Guest
  status: ReservationStatus!
  checkInDate: String
  checkOutDate: String
  totalPrice: Float
  payedPrice: Float
  currency: String
  roomIds: [ID!]!
  rooms: [Room!]!
  accountId: Int
  account: Account
  version: Int!
  createdAt: String
  updatedAt: String
}

type StoredEvent {
  id: Int!
  streamId: String!
  version: Int!
  type: String!
  data: String!
  metadata: String
  occurredAt: String!
}

input CreateReservationInput {
  originId: String
  guestFirstName: String
  guestLastName: String
  guestEmail: String
  checkInDate: String
  checkOutDate: String
  totalPrice: Float
  payedPrice: Float
  currency: String
  roomIds: [ID!]
}

input ConfirmReservationInput {
  reservationId: ID!
  confirmedBy: String
}

input CancelReservationInput {
  reservationId: ID!
  reason: String!
}

input AssignRoomsInput {
  reservationId: ID!
  roomIds: [ID!]!
}

input ReservationFilterInput {
  status: ReservationStatus
  guestName: String
  checkInFrom: String
  checkInTo: String
  checkOutFrom: String
  checkOutTo: String
  createdFrom: String
  createdTo: String
  currency: String
}

type CreateReservationResult {
  reservation: Reservation!
  account: Account
  events: [StoredEvent!]!
}

type ConfirmReservationResult {
  reservation: Reservation!
  events: [StoredEvent!]!
}

type CancelReservationResult {
  reservation: Reservation!
  events: [StoredEvent!]!
}

type AssignRoomsResult {
  reservation: Reservation!
  events: [StoredEvent!]!
}

extend type Query {
  reservation(id: ID!): Reservation
  reservations(filter: ReservationFilterInput, limit: Int, offset: Int): [Reservation!]!
  reservationEventHistory(id: ID!): [StoredEvent!]!
}

extend type Mutation {
  createReservation(input: CreateReservationInput!): CreateReservationResult!
  confirmReservation(input: ConfirmReservationInput!): ConfirmReservationResult!
  cancelReservation(input: CancelReservationInput!): CancelReservationResult!
  assignRooms(input: AssignRoomsInput!): AssignRoomsResult!
  initializeEventSourcingDatabase: Boolean!
  startEventRelayer: Boolean!
  stopEventRelayer: Boolean!
}
