enum ReservationStatus {
  PENDING
  CONFIRMED
  CANCELLED
}

type Reservation {
  id: ID!
  originId: String
  guestName: String
  guestEmail: String
  guestId: ID
  guest: Guest
  status: ReservationStatus!
  checkInDate: String
  checkOutDate: String
  totalAmount: Float
  currency: String
  roomId: ID
  room: Room
  version: Int!
  createdAt: String
  updatedAt: String
}

type StoredEvent {
  id: Int!
  streamId: String!
  version: Int!
  type: String!
  data: String!
  metadata: String
  occurredAt: String!
}

input CreateReservationInput {
  originId: String
  guestFirstName: String
  guestLastName: String
  guestEmail: String
  checkInDate: String
  checkOutDate: String
  totalAmount: Float
  currency: String
  roomId: ID
}

input ConfirmReservationInput {
  reservationId: ID!
  confirmedBy: String
}

input CancelReservationInput {
  reservationId: ID!
  reason: String!
}

input AssignRoomInput {
  reservationId: ID!
  roomId: ID!
}

input ReservationFilterInput {
  status: ReservationStatus
  guestName: String
  checkInFrom: String
  checkInTo: String
  checkOutFrom: String
  checkOutTo: String
  createdFrom: String
  createdTo: String
  currency: String
  roomId: ID
}

type CreateReservationResult {
  reservation: Reservation!
  events: [StoredEvent!]!
}

type ConfirmReservationResult {
  reservation: Reservation!
  events: [StoredEvent!]!
}

type CancelReservationResult {
  reservation: Reservation!
  events: [StoredEvent!]!
}

type AssignRoomResult {
  reservation: Reservation!
  events: [StoredEvent!]!
}

extend type Query {
  reservation(id: ID!): Reservation
  reservations(filter: ReservationFilterInput, limit: Int, offset: Int): [Reservation!]!
  reservationEventHistory(id: ID!): [StoredEvent!]!
}

extend type Mutation {
  createReservation(input: CreateReservationInput!): CreateReservationResult!
  confirmReservation(input: ConfirmReservationInput!): ConfirmReservationResult!
  cancelReservation(input: CancelReservationInput!): CancelReservationResult!
  assignRoom(input: AssignRoomInput!): AssignRoomResult!
  initializeEventSourcingDatabase: Boolean!
  startEventRelayer: Boolean!
  stopEventRelayer: Boolean!
}
